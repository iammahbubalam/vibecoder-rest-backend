# ===========================================
# VibeCoder REST Backend Configuration
# ===========================================

# Application Information
spring.application.name=vibecoder-rest-backend
spring.profiles.active=${ENVIRONMENT:development}

# ===========================================
# Server Configuration
# ===========================================
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=30s

# ===========================================
# Database Configuration
# ===========================================
# MongoDB Configuration with environment variables
spring.data.mongodb.uri=${MONGODB_URI:mongodb://localhost:27017/vibecoder_dev}
spring.data.mongodb.database=${MONGODB_DATABASE:vibecoder_dev}

# Connection pool settings for optimal performance
spring.data.mongodb.options.max-connection-idle-time=30000
spring.data.mongodb.options.max-connection-life-time=60000
spring.data.mongodb.options.max-connection-per-host=20
spring.data.mongodb.options.min-connection-per-host=5

# ===========================================
# Security Configuration
# ===========================================
# OAuth2 Google Configuration
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET}
spring.security.oauth2.client.registration.google.scope=profile,email
spring.security.oauth2.client.registration.google.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}

# JWT Configuration with environment variables
jwt.secret=${JWT_SECRET:lSD3LYgTpptu3z7jN6Mile9SHRqOSWWYGFzUcwA1eZKycw5bx71Dkfp89Z0sW8lIKftxZRLgm3l1575/G8QveQ==}
jwt.access-token.expiration-ms=${JWT_ACCESS_TOKEN_EXPIRATION:900000}
jwt.refresh-token.expiration-ms=${JWT_REFRESH_TOKEN_EXPIRATION:604800000}

# JWT Security Configuration
jwt.security.issuer=vibecoder-backend
jwt.security.audience=vibecoder-frontend
jwt.security.minimum-key-length=512
jwt.security.validate-issuer=true
jwt.security.validate-audience=true

# ===========================================
# Application Properties
# ===========================================
# OAuth2 and CORS Configuration
app.oauth2.redirect-uri=${FRONTEND_URL:http://localhost:3000}/oauth2/redirect
app.cors.allowed-origins=${FRONTEND_URL:http://localhost:3000}
app.admin.emails=${ADMIN_EMAIL:admin@example.com}

# ===========================================
# Actuator & Monitoring
# ===========================================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
management.endpoint.info.enabled=true
management.info.env.enabled=true

# ===========================================
# Logging Configuration
# ===========================================
# Root logging level
logging.level.root=INFO

# Application specific logging
logging.level.com.notvibecoder.backend=INFO

# Security logging (set to DEBUG only in development)
logging.level.com.notvibecoder.backend.security=${SECURITY_LOG_LEVEL:INFO}
logging.level.org.springframework.security=${SECURITY_LOG_LEVEL:INFO}

# Database logging
logging.level.org.springframework.data.mongodb=${DB_LOG_LEVEL:INFO}

# ===========================================
# Performance & Optimization
# ===========================================
# JPA/Data optimizations
spring.jpa.open-in-view=false

# Jackson configuration for JSON processing
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.time-zone=UTC

# HTTP encoding
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

# ===========================================
# Environment Specific Configurations
# ===========================================

# Development Profile
---
spring.config.activate.on-profile=development
logging.level.com.notvibecoder.backend.security=DEBUG
logging.level.org.springframework.security=DEBUG
management.endpoint.health.show-details=always

# Production Profile  
---
spring.config.activate.on-profile=production
logging.level.root=WARN
logging.level.com.notvibecoder.backend=INFO
management.endpoint.health.show-details=never
server.error.include-stacktrace=never
server.error.include-message=never

# Test Profile
---
spring.config.activate.on-profile=test
logging.level.root=WARN
spring.data.mongodb.uri=mongodb://localhost:27017/vibecoder_test
